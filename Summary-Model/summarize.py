from transformers import PreTrainedTokenizerFast, BartForConditionalGeneration

# 요약 함수 (KoBART 모델 사용)
def summarize_text(text):
    model_name = 'gogamza/kobart-summarization'  # KoBART 요약 모델
    tokenizer = PreTrainedTokenizerFast.from_pretrained(model_name)
    model = BartForConditionalGeneration.from_pretrained(model_name)

    # 입력 전처리
    input_ids = tokenizer.encode(text, return_tensors='pt', max_length=1024, truncation=True)

    # 요약 생성
    summary_ids = model.generate(
        input_ids,
        max_length=128,  # 요약의 최대 길이
        min_length=32,   # 요약의 최소 길이
        length_penalty=2.0,
        num_beams=4,
        early_stopping=True
    )
    summary = tokenizer.decode(summary_ids[0], skip_special_tokens=True)

    return summary

# 실행 코드
if __name__ == "__main__":
    # 요약하고 싶은 텍스트 입력
    input_text = """
    외국인투자자가 삼성전자(005930)를 17거래일 연속 순매도하면서 주가를 끌어내렸다. 반면 같은 기간 삼성전자에 대한 '빚투'(빚내서 투자) 수요는 급증한 것으로 나타났다.
1일 한국거래소에 따르면 지난달 30일 삼성전자는 전 거래일 대비 2700원(4.21%) 하락한 6만 1500원에 거래를 마쳤다.
9월 초까지만 해도 7만 4400원(9월 2일 종가)이었던 주가가 한 달 새 17% 넘게 고꾸라진 것이다.
외국인투자자 자금이 빠져나간 영향이 컸다. 외국인투자자는 최근 17거래일 연속으로 매도 우위 보이며 삼성전자를 8조 7592억 원어치 순매도했다. 9월 첫 거래일인 지난달 2일을 제외하고 9월 내내 삼성전자를 팔아치운 셈이다.
이로써 외국인투자자는 2년 5개월여 만에 최장기간 순매도 기록을 다시 세웠다. 앞서 외국인투자자는 지난 2022년 3월 25일부터 같은 해 4월 28일까지 25거래일 연속 삼성전자 주식을 팔았다.
반면 개인투자자는 17거래일 동안 삼성전자를 총 8조 7592억 원 순매수하며 외국인투자자가 던진 물량을 모두 받아냈다.
외국인투자자 자금이 빠져나가면서 삼성전자 주가가 바닥을 기는 동안 신용거래융자 잔고(신용잔고)는 급증했다.
코스콤 체크에 따르면 삼성전자 신용잔고는 결제일 기준 9월 5일 6435억 원에서 9월 30일 8750억 원으로 증가했다. 결제는 거래 체결일로부터 2거래일 뒤(T+2) 이뤄진다는 점을 고려하면 신용잔고는 지난달 3일부터 26일까지 2316억 원가량 늘어난 셈이다. 집계가 불가능한 9월 27일과 30일 체결분은 제외했다.
삼성전자는 전체 종목 중 신용잔고가 압도적으로 많이 증가한 종목이었다. 같은 기간 신용잔고 증가 규모 2·3위는 유한양행과 고려아연으로, 이들의 신용잔고는 각각 963억 원, 483억 원 증가했다.
저가매수를 노린 개미들의 빚투가 증가하는 가운데 증권가에선 삼성전자가 올해 3분기 컨센서스(시장 예상치)를 하회하는 실적을 기록할 것이란 전망이 나왔다.
정민규 상상인증권(001290) 연구원은 "하반기 기대했던 핵심 고객사향 고대역폭메모리(HBM) 양산 공급 진입 가시성이 낮아지고 폴더블 스마트폰 실적이 부진했다"며 "올해 3분기 매출액과 영업이익은 각각 81조 2000억 원, 10조 6000억 원으로 컨센서스(영업이익 11조 2000억 원)를 소폭 하회할 전망"이라고 했다.
증권가에선 주가 조정이 끝났다는 의견과 추가 하락 가능성이 있다는 의견이 모두 나왔다.
백길현 유안타증권(003470) 연구원은 "단기적으로 레거시 메모리반도체 가격 상승 모멘텀이 둔화할 가능성을 고려해 2024년 하반기~2025년 실적 추정치를 최근 하향 조정했는데, 이는 대부분 최근 주가 조정에 반영됐다"고 설명했다.
송명섭 iM증권 연구원은 "삼성전자의 현 주가는 경기와 업황이 둔화하는 최악의 경우 10%대 중반 수준의 추가 하락 가능성을 보유하고 있다"면서도 "6만 원 이하 주가는 장기적 관점에서 매수가 가능한 가격대"라고 했다.
    """

    # 요약 생성
    summary = summarize_text(input_text)
    print("\nSummary:\n", summary)